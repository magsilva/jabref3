<HTML>

<BODY text="#275856">
<basefont size="4" color="#2F4958" face="arial">

<H1>Externe Importfilter</H1>

<p>JabRef bietet Ihnen die Möglichkeit, ganz ähnlich den Standard-Importern, eigene Importer 
zu definieren und zu benutzen. Man definiert einen Importer durch eine oder mehrere Java
<i>Klassen</i>, die Dateinhalte aus einem sogenannten <i>Input stream</i> lesen
und daraus BibTex-Einträge erzeugen. Sie können vorkompilierte Importer einbinden, die Sie vielleicht 
von SourceForge erhalten haben (siehe "Ihre Arbeit anderen zur Verfügung stellen"). Sie können auch
mit Grundkenntnissen der Java-Programmierung eigene Importer für für Sie wichtige Referenzquellen 
erstellen oder neue, verbesserte Versionen existierender Importer einbinden, ohne JabRef neu zu
kompilieren.</p> 

<p>Externe Importfilter haben Vorrang vor Standard-Importern. So können Sie mit Ihren Importern
die existierenden in der automatischen Formaterkennung und an der Kommandozeile in JabRef überschreiben.
Externe Importfilter selbst sind dann nach Namen sortiert.</p>

<H2>Einen externen Importfilter hinzufügen</H2>

<p>Stellen Sie sicher, dass Sie den Importer in kompilierter Form haben (eine oder mehrere
<code>.class</code> Dateien) und dass die Klassendateien
in einer Verzeichnisstruktur entsprechend ihrer Package-Struktur liegen. 
Um einen neuen externen Importfilter hinzuzufügen, öffnen Sie den Dialog 
<b>Optionen -> Verwalte externe Importfilter</b>, und klicken Sie auf
<b>Aus Klassenpfad hinzufügen</b>. Ein Dateiauswahl-Fenster erscheint, 
mit dem Sie den Klassenpfad des Importers wählen, dass heißt den obersten Ordner,
in dem die Package-Struktur Ihres Importers beginnt. In einem zweiten Dateiauswahl-Fenster
wählen Sie die <i>.class</i>-Datei Ihres Importers, die von <code>ImportFormat</code> abgeleitet
ist. Wenn Sie <b>Klasse auswählen</b> klicken, erscheint Ihr neuer Importer
in der Liste der externen Importfilter. Alle externen Importfilter erscheinen in den
JabRef-Submenüs <b>Datei -> Importieren -> Externe Importfilter</b> und 
<b>Datei -> Importieren und Anhängen -> Externe Importfilter</b>.</p>

<p>Bitte beachten Sie: wenn Sie die Klassen in ein anderes Verzeichnis verschieben,
müssen Sie den Importer entfernen und neu hinzufügen. Wenn Sie einen Importfilter
mit einem bereits vorhandenen Namen registrieren, ersetzt JabRef den vorhandenen
externen Importfilter. Auch wenn es in manchen Fällen möglich ist, einen schon registrierten
Importer zu aktualisieren ohne JabRef neu zu starten (nämlich dann,
wenn der Importer nicht im Klassenpfad von JabRef ist), empfehlen wir, grundsätzlich
JabRef neu zu starten, wenn Sie ein Update eines externen Importers durchgeführt haben.
Es ist noch nicht möglich, Importer aus ZIP- oder JAR-Archiven zu registrieren,
bitte extrahieren Sie die Importfilter erst.</p>

<H2>Einen Importfilter entwickeln</H2>

Bitte schauen Sie auf unseren Download-Seiten nach Beispielen und nützliche Dateien zur 
Entwicklung Ihres Importfilters.

<H3>Ein einfaches Beispiel</H3>

<p>Angenommen, wir wollen Dateien der folgenden Form importieren:
<pre>
1936;John Maynard Keynes;The General Theory of Employment, Interest and Money
2003;Boldrin & Levine;Case Against Intellectual Monopoly
2004;ROBERT HUNT AND JAMES BESSEN;The Software Patent Experiment
</pre></p>

<p>Erzeugen Sie in einem Text-Editor eine von <code>ImportFormat</code> abgeleitete Klasse,
die die Methoden <code>getFormatName()</code>, <code>isRecognizedFormat()</code>
und <code>importEntries()</code> implementiert. Hier ein Beispiel:
<pre>
import java.io.*;
import java.util.*;
import net.sf.jabref.*;
import net.sf.jabref.imports.ImportFormat;
import net.sf.jabref.imports.ImportFormatReader;

public class SimpleCsvImporter extends ImportFormat {

  public String getFormatName() {
    return "Simple CSV Importer";
  }

  public boolean isRecognizedFormat(InputStream stream) throws IOException {
    return true; // this is discouraged except for demonstration purposes
  }
  
  public List importEntries(InputStream stream) throws IOException {    
  	ArrayList bibitems = new ArrayList();
    BufferedReader in = new BufferedReader(ImportFormatReader.getReaderDefaultEncoding(stream));
      
    String line = in.readLine();
    while (line != null) {
      if (!"".equals(line.trim())) {
        String[] fields = line.split(";");
        BibtexEntry be = new BibtexEntry(Util.createNeutralId());
        be.setType(BibtexEntryType.getType("techreport"));
        be.setField("year", fields[0]);
        be.setField("author", fields[1]);
        be.setField("title", fields[2]);
        bibitems.add(be);
        line = in.readLine();
      }     
    }
  	return bibitems;	  	
  }
}
</pre></p>

<p>Beachten Sie, dass die Beispielklasse im Default-Package liegt. Angenommen, Sie haben
sie unter <code>/meinpfad/SimpleCsvImporter.java</code> gespeichert. Nehmen wir weiter an,
die Datei <i>JabRef-2.0.jar</i> ist im gleichen Verzeichnis wie
<code>SimpleCsvImporter.java</code> und Java ist in Ihrem Kommandopfad. 
Kompilieren Sie die Klasse mit JSDK 1.4 zum Beispiel mit folgendem Kommandozeilen-Aufruf: 
<pre>
javac -classpath JabRef-2.0.jar SimpleCsvImporter.java
</pre>
Nun sollte dort auch eine Datei <code>/mypath/SimpleCsvImporter.class</code> liegen.</p>

<p>Öffnen Sie in JabRef <b>Optionen -> Verwaltung externer Importfilter</b> und klicken Sie
auf <b>Aus Klassenpfad hinzufügen</b>. Navigieren Sie nach <code>/meinpfad</code> und 
klicken Sie <b>Klassenpfad auswählen</b>. Wählen Sie dann <code>SimpleCsvImporter.class</code>
und klicken Sie <b>Klasse auswählen</b>. Ihr Importfilter sollte nun in der Liste der
externen Importfilter unter dem Namen "Simple CSV Importer" erscheinen, und,
sobald Sie <b>Schließen</b> gewählt haben, auch in den Untermenüs <b>Datei -> Importieren -> 
Externe Importfilter</b> und <b>Datei -> Importieren und Anhängen -> Externe Importfilter</b> 
des JabRef-Hauptfensters.</p>

<H2>Ihre Arbeit anderen zur Verfügung stellen</H2>

Mit externen Importfiltern ist es recht einfach, Importfilter zwischen Nutzern auszutauschen und
gemeinsam zu nutzen. Wenn Sie einen Importer für ein  Format schreiben, das JabRef noch nicht unterstützt, 
oder einen Importer verbessern, bitten wir Sie, Ihre Ergebnisse auf unserer SourceForge.net 
Seite zu veröffentlichen. Wir bieten gerne eine Sammlung eingereichter Importfilter an oder 
fügen sie unserer Auswahl an Standard-Importfiltern hinzu.

</HTML>
