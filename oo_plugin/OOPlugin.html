<h1>OpenOffice plugin for JabRef</h1>

        <h2>Introduction</h2>

	<p><a href="http://jabref.sf.net">JabRef</a> is an open source BibTeX bibliography
	  manager.
        <p>This plugin offers an interface for inserting citations and formatting a Bibliography in an
        OpenOffice writer document from JabRef.</p>


        <h2>Current state of the plugin</h2>

        As of 2 September 2008, the stable version of JabRef supports plugins.
        The OO plugin is in a very preliminary state, and the reason it is being
        distributed at this stage is to allow others to test it and give their feedback.

        <p><b>Updates:</b></p>
        2008-10-19: Version 0.0.9: Enabled connection to OpenOffice.org 3. Streamlined connection process.<br>
        2008-09-03: Version 0.0.8: No major changes, but packaged with JabRef 2.4.<br>
        2008-02-20: Version 0.0.7: New interface for style selection. Styles can now specify paragraph format.<br>
        2008-02-13: Version 0.0.6: Sorting and grouping of number citation markers.<br>
        2008-02-06: Version 0.0.5: Modified style file format. Fixed bug in handling names with elements like "van der".<br>
        2008-01-09: Version 0.0.4: Style file is now automatically reloaded if modified.<br>
        2007-12-17: Version 0.0.3: From this version, we bypass OO's built-in bibliographic system.<br>
        2007-12-04: Version 0.0.2<br>
        2007-12-01: Version 0.0.1<br>

        <p><b>Downloads:</b></p>
        <p><a href="JabRef-oo-0.0.9.zip">JabRef with OO plugin.</a> This is a build of the SVN version of JabRef
        from Feb 6th 2008, packaged with the OO plugin included. Keep in mind that this is not a stable
        version of JabRef, so it should be used with care.</p>
        <p><a href="JabRef-oo-0.0.9-src.zip">Plugin source code.</a> The source code tree includes four
        OpenOffice.org jars and a build of the SVN version of JabRef. The plugin is built using
        an included Ant build file.</p>
        <p><a href="example_style_file.jstyle">Example style file</a></p>

        <p>The plugin is distributed under the terms of the GNU
        <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">General Public License</a>,
        version 2 or later.</p>

        <h2>Using the OpenOffice interface</h2>

        <p>To communicate with OpenOffice, the OO plugin must first connect to a running OpenOffice
        instance. You need to start OpenOffice and enter your document before connecting from
        JabRef. The plugin needs to know the location of your OpenOffice executable (<b>soffice.exe</b> on
        Windows, and <b>soffice</b> on other platforms), and the directory where several OpenOffice
        jar files reside. If you connect by clicking the <b>Connect</b> button, the plugin will try to
        automatically determine these locations. If this does not work, you need to connect using the
        <b>Manual connect</b> button, which will open a window asking you for the needed locations.</p>

        <p>After the connection has been established, you can insert citations by selecting one or more
        entries in JabRef and using the <b>Push to OpenOffice</b> button in the dropdown menu of JabRef's
        toolbar, or by using the appropriate button in the OpenOffice plugin panel in the side pane. This
        will insert citations for the selected entries at the current cursor position in the OpenOffice
        document, and update the bibliography to contain the full reference.</p>

        <p><b>Note:</b> JabRef does not use OpenOffice's built-in bibliography system, because of the
        limitations of that system. A document containing citations inserted from JabRef will
        not generally be compatible with other reference managers such as Bibus and Zotero.</p>

        <p>Two different types of citations
        can be inserted - either a citation in parenthesis, "(Author 2007)", or an in-text citation,
        "Author (2007)". This distinction is only meaningful if author-year citations are used instead of
        numbered citations, but the distinction will be preserved if you switch between the two styles.</p>

        <p>If you modify entries in JabRef after inserting their citations into OpenOffice, you will
        need to synchronize the bibliography. The <b>Sync OO bibliography</b> button will update all
        entries of the bibliography, provided their BibTeX keys have not been altered (JabRef encodes the
        BibTeX key into the reference name for each citation to keep track of which BibTeX key
        the original JabRef entry has).</p>

        <h3>The style file</h3>

        You need to select a style file before connecting to OpenOffice - an external file which is selected
        using a standard file dialog. The style file defines the
        format of citations and the format of the bibliography. You can use standard JabRef export
        formatters to process entry fields before they are sent to OpenOffice.
        Through the style file, the intention is to give as much flexibility in citation styles as possible.
        
        <p>Here is an example style file:</p>
        <code><pre>
PROPERTIES
Title=Bibliography
IsSortByPosition=false
IsNumberEntries=false

CITATION
AuthorField=author/editor
YearField=year
MaxAuthors=3
AuthorSeparator=,
AuthorLastSeparator= &
EtAlString= et al.
YearSeparator=,
InTextYearSeparator=
BracketBefore=[
BracketAfter=]
CitationSeparator=;
UniquefierSeparator=,

LAYOUT
article=\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\author} (&lt;b&gt;\format[FormatChars]{\year}\uniq&lt;/b&gt;).<br>&lt;i&gt;\format[FormatChars]{\title}&lt;/i&gt;, \journal \volume : \format[FormatPagesForHTML]{\pages}.

book=\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\author}\begin{editor}\format[AuthorLastFirst,<br>AuthorAbbreviator,AuthorAndsReplacer]{\editor} (Ed.)\end{editor}, &lt;b&gt;\year\uniq&lt;/b&gt;. &lt;i&gt;\format[FormatChars]{\title}&lt;/i&gt;.<br>\format[FormatChars]{\publisher}, \format[FormatChars]{\address}.

incollection=\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\author} (&lt;b&gt;\year\uniq&lt;/b&gt;).<br>&lt;i&gt;\format[FormatChars]{\title}&lt;/i&gt;. In: \format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\editor} (Ed.),<br>&lt;i&gt;\format[FormatChars]{\booktitle}&lt;/i&gt;, \format[FormatChars]{\publisher}.

inbook=\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\author} (&lt;b&gt;\year\uniq&lt;/b&gt;).<br> &lt;i&gt;\format[FormatChars]{\chapter}&lt;/i&gt;. In: \format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\editor} (Ed.),<br> &lt;i&gt;\format[FormatChars]{\title}&lt;/i&gt;, \format[FormatChars]{\publisher}.

default=\format[AuthorLastFirst,AuthorAbbreviator,AuthorAndsReplacer]{\author} (&lt;b&gt;\year\uniq&lt;/b&gt;).<br> &lt;i&gt;\format[FormatChars]{\title}&lt;/i&gt;, \journal.
</pre>

<p>(Note that the layout for each entry type must be constrained to a single line in the style file - above, the lines are broken up to improve readability.)</p>
        </code>

        <p>The <b>PROPERTIES</b> section describes global properties for the bibliography:
            <ul><li><code>Title</code>: determines the header text for the bibliography.</li></ul>
            <ul><li><code>IsSortByPosition</code>: determines how the bibliography is sorted. If true, the entries
                will be sorted according to the order in which they are cited. If false, the entries will be
                sorted alphabetically by authors.</li></ul>
            <ul><li><code>IsNumberEntries</code>: determines the type of citations to use. If true, number
                citations will be used. The citation numbers will be included in the bibliography as well.
                If false, author-year citations will be used.</li></ul>
        </p>

        <p>The <b>CITATION</b> section describes the format of the citation markers inserted into the text.
        If numbered entries are used, only the <code>BracketBefore</code> and <code>BracketAfter</code> properties
        are relevant - they define which characters the citation number is wrapped in. The citation is composed
        as follows:<br>
            [BracketBefore][Number][BracketAfter]<br>
        where [Number] is the number of the citation, determined according to the ordering of the bibliography and/or
        the position of the citation in the text.
        </p>
        <p>If numbered entries are not used, author-year citations will be created based on the citation properties.
        A parenthesis citation is composed as follows:<br>
            [BracketBefore][Author][YearSeparator][Year][BracketAfter]<br>
        where [Author] is the result of looking up the field or fields given in the <code>AuthorField</code> property,
        and formatting a list of authors. The list can contain up to <code>MaxAuthors</code> names - if more are present,
        the list will be composed as the first author plus the text specified in the property <code>EtAlString</code>.
        If several, slash-separated, fields are given in the <code>AuthorField</code> property, they will be looked up
        successively if the first field is empty for the given BibTeX entry. In the example above, the "author" field will
        be used, but if empty, the "editor" field will be used as a backup.
        <p>The names in the author list will be separated by the text given by the <code>AuthorSeparator</code>
        property, except for the last two names, which will be separated by the text given by <code>AuthorLastSeparator</code>.
        </p>
        <p>[Year] is the result of looking up the field or fields given in the [YearField] property.</p>
        An in-text citation is composed as follows:<br>
            [Author][InTextYearSeparator][BracketBefore][Year][BracketAfter]<br>
        where [Author] and [Year] are resolved in exactly the same way as for the parenthesis citations.
        </p>
        <p>If two different cited sources have the same authors and publication year, and author-year citations are used,
        their markers will need modification in order to be distinguishable. This is done automatically by appending a
        letter after the year for
        each of the publications; 'a' for the first cited reference, 'b' for the next, and so on.
        For instance, if the author "Olsen" has two cited papers from 2005, the citation markers will be modified to
        <code>(Olsen, 2005a)</code> and <code>(Olsen, 2005b)</code>. In the bibliography
        layout, the placement of the "uniquefier" letter is indicated explicitly by inserting the virtual field
        <code>uniq</code>.</p>
        <p>If several entries that have been "uniquefied" are cited together, they will be grouped in the citation
        marker. For instance, of the two entries in the example above are cited together, the citation marker will
        be <code>(Olsen, 2005a, b)</code> rather than <code>Olsen, 2005a; Olsen, 2005b)</code>. The grouped uniquefier
        letters (a and b in our example) will be separated by the string specified by the <code>UniquefierSeparator</code>
        property.
        </p>

        <p>The <b>LAYOUT</b> section describes how the bibliography entry for each entry type in JabRef
        should appear. Each line should start with either the name of a BibTeX entry type, or the word
        <code>default</code>, followed by a '='. The <code>default</code> layout will be used for all
        entry types for which an explicit layout hasn't been given.</p>
        <p>The remainder of each line defines the layout, with normal text and spaces appearing literally
        in the bibliography entry. Information from the BibTeX entry is inserted by adding <code>\field</code> markers
        with the appropriate field name (e.g. <code>\author</code> for inserting the author names). Formatting
        information for the field can be included here, following JabRef's standard export layout syntax.
        Refer to <a href="http://jabref.sourceforge.net/help/CustomExports.php">JabRef's documentation on custom export filters</a>
        for more information about which formatters are available.</p>
        <p>If author-year citations are used, you have to explicitly specify the position of the "uniquefier" letter
        that is added to distinguish similar-looking citations. This is done by including a marker for the virtual field
        <code>uniq</code>, typically right after the year (as shown in the example style file). The <code>uniq</code>
        field is automatically set correctly for each entry before its reference text is laid out.
        </p>
        <p>To indicate formatting in the bibliography, you can use the HTML-like tag pairs &lt;b&gt; &lt;/b&gt; and
         &lt;i&gt; &lt;/i&gt; to specify bold text and italic text, respectively.</p>

<h2>Known issues</h2>

<ul>
  <li>There is currently no support for footnote based citations.</li>
  <li>The cursor may be poorly positioned after inserting a citation.</li>
  <li>Copy-pasting the example style file directly from this page can give an unparseable
    file. To avoid this, instead download the example file from the link in the download section.</li>
</ul>

<h2>Contact</h2>

If you have tested this plugin, and want to give your feedback, or if you
want to contribute to the development of the plugin, please contact me at the
e-mail address mortenalver at users.sourceforge.net.

        
